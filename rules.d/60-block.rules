# do not edit this file, it will be overwritten on update
# This has been downgraded to avoid hitting the following nbd bug on linuxkits old kernel:
# https://lore.kernel.org/lkml/6efae367-12fa-1a58-7438-1b39dc0d6ef8@huawei.com/T/#mcecfc05d17a0a5ba42e7b46386e9ca3c858b3e80

# enable in-kernel media-presence polling
ACTION=="add", SUBSYSTEM=="module", KERNEL=="block", ATTR{parameters/events_dfl_poll_msecs}=="0", \
  ATTR{parameters/events_dfl_poll_msecs}="2000"

# forward scsi device event to corresponding block device
ACTION=="change", SUBSYSTEM=="scsi", ENV{DEVTYPE}=="scsi_device", TEST=="block", ATTR{block/*/uevent}="change"

# watch metadata changes, caused by tools closing the device node which was opened for writing
ACTION!="remove", SUBSYSTEM=="block", KERNEL=="loop*|nvme*|sd*|vd*|xvd*|pmem*|mmcblk*", OPTIONS+="watch"